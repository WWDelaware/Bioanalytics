"0","analyze_data <- function(data) {"
"0","  # Преобразование данных для ANOVA"
"0","  data_long <- data %>%"
"0","    mutate(run = row_number()) %>% "
"0","    pivot_longer(cols = starts_with(""rep""), names_to = ""replication"", values_to = ""response"") "
"0",""
"0","  # Проведение ANOVA"
"0","  model <- aov(response ~ (A + B + C + D + E) * replication, data = data_long)"
"0","  summary(model)"
"0",""
"0","  #Определение компонентов дисперсии"
"0","  mixed_model <- lmer(response ~ (1 | A) + (1 | B) + (1 | C) + (1 | D) + (1 | E)+ (1 | replication), data = data_long)"
"0","  vc <- VarCorr(mixed_model)"
"0","  var_factors <- sapply(vc, as.numeric)"
"0","  var_error <- attr(vc, ""sc"")^2"
"0",""
"0","  # Вывод результатов"
"0","  cat(""var(factors):"", var_factors, ""\n"")"
"0","  cat(""var(error):"", var_error, ""\n"")"
"0","  print(""Variance components table"")"
"0","  print(vc)"
"0","}"
